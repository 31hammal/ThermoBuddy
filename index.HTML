<script>
  const buyBtn = document.getElementById('buyNow');
  const backdrop = document.getElementById('modalBackdrop');
  const confirmBtn = document.getElementById('confirmBtn');

  // Open checkout modal
  function openModal(){
    backdrop.style.display = 'flex';
    backdrop.setAttribute('aria-hidden','false');
    document.body.style.overflow = 'hidden';
  }

  function closeModal(){
    backdrop.style.display = 'none';
    backdrop.setAttribute('aria-hidden','true');
    document.body.style.overflow = '';
  }

  buyBtn.addEventListener('click', openModal);
  backdrop.addEventListener('click', (e)=>{
    if(e.target === backdrop) closeModal();
  });

  // ------------------------------------
  // THANK YOU SCREEN SETUP
  // ------------------------------------
  const thankYouModal = document.getElementById("thankYouModal");
  const closeTY = document.getElementById("closeTY");

  closeTY.onclick = function(){
    thankYouModal.style.display = "none";
  }

  // When user clicks Confirm Purchase
  confirmBtn.addEventListener('click', ()=>{
    const qty = document.getElementById('qty').value || 1;
    const style = document.getElementById('styleSelect').value || 'Classic Violet-Blue';
    const first = document.getElementById('firstName').value || 'Friend';

    // Close checkout first
    closeModal();

    // Slight delay for smoother transition
    setTimeout(()=>{
      // Open final thank you modal
      thankYouModal.style.display = "flex";

      // (Optional) personalize message
      document.getElementById("tyMessage").innerText =
        `${first}, your order of ${qty}Ã— ThermoBuddy (${style}) has been received!`;

    }, 150);
  });

  // Escape key closes modals
  document.addEventListener('keydown', (e)=>{
    if(e.key === 'Escape'){
      closeModal();
      thankYouModal.style.display = "none";
    }
  });
</script>
